jar.configure {
	manifest {
		attributes(
			'FMLCorePluginContainsFMLMod': 'true',
			'FMLCorePlugin': 'gregtech.asm.GT_ASM'
		)
	}
}


// Use our own config file so we can customize checks, mainly star imports since GT6 uses so many in specific ways
project.getExtensions().getByType(CheckstyleExtension.class).setConfigFile(new File(project.projectDir, 'checkstyle.xml'));


artifacts {
	archives changelog.output, supporterlist.output, supporterlistgold.output, defaultConfigPack
}


// Really gtnh, why are the project artifacts not default included like normal?
publishing.publications["maven"].with {
	artifact(changelog.output) {
		classifier = "changelog"
		builtBy changelog
	}
	artifact(supporterlist.output) {
		classifier = "supporterlist"
		builtBy supporterlist
	}
	artifact(supporterlistgold.output) {
		classifier = "supporterlistgold"
		builtBy supporterlistgold
	}
	artifact(defaultConfigPack)
}


if ( !project.buildInfo.tag.contains("-dirty") && (System.getenv().ONLY_RELEASES!="true" || project.buildInfo.isRelease) ) {
	task testIfUploadable {}


//	// Not using GTNH's because they use different naming conventions for the envvars and properties or are just outright missing
//	publishing {
//		repositories {
//			maven {
//				url = mavenURL
//			}
//		}
//	}

//	uploadArchives {
//		dependsOn jar
//		repositories {
//			mavenDeployer {
//				repository(url: mavenURL) {
//					authentication(userName: mavenUsername, password: mavenPassword)
//				}
//			}
//		}
//	}
}
